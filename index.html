<!DOCTYPE html>
<html lang="es" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZIP Preview</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
            if (e.matches) document.documentElement.classList.add('dark');
            else document.documentElement.classList.remove('dark');
        });
    </script>
    <style>
        * {
            @apply transition-colors;
        }

        #previewContent {
            @apply whitespace-pre-wrap;
            word-break: break-word;
        }

        #fileTree::-webkit-scrollbar {
            @apply w-1.5;
        }

        #fileTree::-webkit-scrollbar-track {
            @apply bg-transparent;
        }

        #fileTree::-webkit-scrollbar-thumb {
            @apply bg-zinc-300 dark:bg-zinc-700 rounded hover:bg-zinc-400 dark:hover:bg-zinc-600;
        }

        #previewContent::-webkit-scrollbar {
            @apply w-1.5;
        }

        #previewContent::-webkit-scrollbar-track {
            @apply bg-transparent;
        }

        #previewContent::-webkit-scrollbar-thumb {
            @apply bg-zinc-300 dark:bg-zinc-700 rounded hover:bg-zinc-400 dark:hover:bg-zinc-600;
        }
    </style>
</head>

<body class="bg-white dark:bg-zinc-950 text-zinc-900 dark:text-zinc-50 h-screen overflow-hidden">
    <div class="h-screen flex flex-col">
        <!-- Header -->
        <header class="border-b border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900">
            <div class="px-4 py-4 flex items-center justify-between">
                <div>
                    <h1 class="text-2xl font-semibold">ZIP Preview</h1>
                </div>
                <div class="flex items-center gap-3">
                    <input type="text" id="urlInput" placeholder="URL del ZIP"
                        class="bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-md px-3 py-1.5 text-xs text-zinc-900 dark:text-zinc-50 focus:outline-none focus:ring-2 focus:ring-zinc-900 dark:focus:ring-zinc-50 focus:border-transparent w-48">
                    <button onclick="loadZipFromUrl()"
                        class="bg-zinc-900 dark:bg-zinc-50 text-white dark:text-zinc-900 px-3 py-1.5 rounded-md text-xs font-medium hover:bg-zinc-800 dark:hover:bg-zinc-200 focus:outline-none focus:ring-2 focus:ring-zinc-900 dark:focus:ring-zinc-50 focus:ring-offset-2 dark:focus:ring-offset-zinc-950">Cargar</button>

                    <label for="fileInput"
                        class="bg-zinc-900 dark:bg-zinc-50 text-white dark:text-zinc-900 px-3 py-1.5 rounded-md text-xs font-medium hover:bg-zinc-800 dark:hover:bg-zinc-200 focus:outline-none focus:ring-2 focus:ring-zinc-900 dark:focus:ring-zinc-50 focus:ring-offset-2 dark:focus:ring-offset-zinc-950">
                        Subir
                    </label>
                    <input type="file" id="fileInput" accept=".zip" class="hidden">
                </div>
            </div>
        </header>

        <!-- Notificaciones Flotantes -->
        <div id="loading"
            class="hidden fixed bottom-4 right-4 px-4 py-3 bg-blue-50 dark:bg-blue-950 border border-blue-200 dark:border-blue-800 text-xs text-blue-600 dark:text-blue-400 flex items-center gap-2 rounded-lg shadow-lg z-50">
            <div
                class="animate-spin h-3 w-3 border border-blue-600 dark:border-blue-400 border-t-transparent rounded-full">
            </div>
            <span>Cargando...</span>
        </div>
        <div id="error"
            class="hidden fixed bottom-4 right-4 px-4 py-3 bg-red-50 dark:bg-red-950 border border-red-200 dark:border-red-800 text-xs text-red-600 dark:text-red-400 rounded-lg shadow-lg z-50">
        </div>
        <div id="success"
            class="hidden fixed bottom-4 right-4 px-4 py-3 bg-green-50 dark:bg-green-950 border border-green-200 dark:border-green-800 text-xs text-green-600 dark:text-green-400 rounded-lg shadow-lg z-50">
        </div>

        <!-- Main Content -->
        <main class="flex-1 overflow-hidden w-full">

            <!-- Results Section -->
            <div id="results" class="hidden h-full">
                <!-- File Browser -->
                <div
                    class="border border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900 overflow-hidden flex flex-col h-full">
                    <!-- Content Area -->
                    <div class="flex flex-1 overflow-hidden">
                        <!-- File Tree -->
                        <div class="w-1/3 border-r border-zinc-200 dark:border-zinc-800 flex flex-col">
                            <div class="p-3 border-b border-zinc-200 dark:border-zinc-800 flex-shrink-0">
                                <div class="flex items-center justify-between">
                                    <h3 class="text-xs font-semibold text-zinc-800 dark:text-zinc-100 truncate flex-1"
                                        id="fileName">-</h3>
                                    <div class="flex gap-1 flex-shrink-0">
                                        <button id="expandBtn" onclick="expandAllDirectories()"
                                            class="px-2 py-0.5 text-xs rounded bg-zinc-200 dark:bg-zinc-700 text-zinc-800 dark:text-zinc-100 hover:bg-zinc-300 dark:hover:bg-zinc-600 transition-colors"
                                            title="Expandir todo">+</button>
                                        <button id="collapseBtn" onclick="collapseAllDirectories()"
                                            class="px-2 py-0.5 text-xs rounded bg-zinc-200 dark:bg-zinc-700 text-zinc-800 dark:text-zinc-100 hover:bg-zinc-300 dark:hover:bg-zinc-600 transition-colors"
                                            title="Contraer todo">−</button>
                                    </div>
                                </div>
                            </div>
                            <div class="p-3 overflow-y-auto flex-1">
                                <div id="fileTree" class="space-y-0 text-sm"></div>
                            </div>
                        </div>

                        <!-- File Preview -->
                        <div class="w-2/3 overflow-y-auto">
                            <div id="filePreview" class="hidden p-3 h-full flex flex-col">
                                <div
                                    class="mb-2 pb-2 border-b border-zinc-200 dark:border-zinc-800 sticky top-0 bg-white dark:bg-zinc-900 py-1 flex items-center justify-between">
                                    <h3 class="text-xs font-semibold text-zinc-800 dark:text-zinc-100"
                                        id="previewTitle"></h3>
                                    <div class="flex items-center gap-2">
                                        <button onclick="copyToClipboard()"
                                            class="text-zinc-600 dark:text-zinc-400 hover:text-zinc-900 dark:hover:text-zinc-100 transition-colors"
                                            title="Copiar contenido">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.657 1.343 -3 3 -3h10c.75 0 1.158 .385 1.5 1" /></svg>
                                        </button>
                                        <button onclick="downloadCurrentFile()"
                                            class="text-zinc-600 dark:text-zinc-400 hover:text-zinc-900 dark:hover:text-zinc-100 transition-colors"
                                            title="Descargar archivo">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2" /><path d="M7 11l5 5l5 -5" /><path d="M12 4l0 12" /></svg>
                                        </button>
                                    </div>
                                </div>
                                <div id="previewContent"
                                    class="bg-zinc-50 dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800 rounded p-4 font-mono text-xs text-zinc-700 dark:text-zinc-300 overflow-auto flex-1 whitespace-pre-wrap">
                                </div>
                            </div>
                            <div id="emptyState"
                                class="p-3 text-center text-zinc-500 dark:text-zinc-400 h-full flex items-center justify-center">
                                <p class="text-xs">Selecciona un archivo para visualizar</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Status Bar -->
        <footer
            class="border-t border-zinc-200 dark:border-zinc-800 bg-zinc-50 dark:bg-zinc-800 text-xs text-zinc-600 dark:text-zinc-400 px-4 py-1.5 flex items-center gap-4 flex-wrap">
            <span>Archivos: <span id="statusFileCount">0</span></span>
            <span>Carpetas: <span id="statusDirCount">0</span></span>
            <span>Tamaño: <span id="statusSize">0 B</span></span>
            <span>Comprimido: <span id="statusCompressed">0 B</span></span>
            <span>Ratio: <span id="statusRatio">0%</span></span>
            <span>Modificado: <span id="statusDate">-</span></span>
        </footer>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="app.js"></script>
</body>

</html>